# Script de conexion
	GO
--Se crea la tabla clientes
CREATE TABLE CLIENTES
(
	ID INT IDENTITY (1,1) PRIMARY KEY NOT NULL,
	TIPOCLIENTE INT NOT NULL,
	PADREID INT,
	DOCUMENTO VARCHAR(11) NOT NULL,
	NOMBRES VARCHAR(50) NOT NULL,
	APELLIDOS VARCHAR(50) NOT NULL,
	FECHANACIMIENTO DATE NOT NULL,
	
	--Estableciendo llave foranea
	CONSTRAINT FK_CLIENTES_TIPOCLIENTE FOREIGN KEY (TIPOCLIENTE) REFERENCES TIPOCLIENTE (ID),
	CONSTRAINT FK_CLIENTES_PADRE FOREIGN KEY (PADREID) REFERENCES CLIENTES (ID)
)
	GO




--Procedimiento para INSERTAR, MODIFICAR Y ELIMINAR
CREATE PROCEDURE CRUDCLIENTES
	@DOCUMENTO VARCHAR(11),
	@NOMBRES VARCHAR(50),
	@APELLIDOS VARCHAR(50),
	@FECHANACIMIENTO DATE,
	@CRUD CHAR(1)

AS  --Si el CRUD es igual a I = Inserte los registros
	IF @CRUD = 'I'
	BEGIN
		INSERT CLIENTES VALUES(@DOCUMENTO, @NOMBRES, @APELLIDOS, @FECHANACIMIENTO)
	END
	--Si el CRUD es igual a U = Actualice los registros
	IF @CRUD = 'U'
	BEGIN
		UPDATE CLIENTES SET NOMBRES=@NOMBRES, APELLIDOS=@APELLIDOS, FECHANACIMIENTO=@FECHANACIMIENTO WHERE DOCUMENTO = @DOCUMENTO
	END
	--Si el CRUD es igual a E = Elimine los registros
	IF @CRUD = 'E'
	BEGIN
		DELETE FROM CLIENTES WHERE DOCUMENTO=@DOCUMENTO
	END;
	GO

--Insertamos datos en la tabla
INSERT CLIENTES VALUES ('654321','GUILLERMO', 'JIMENEZ','1999-11-23')
INSERT CLIENTES VALUES ('654320','CRISTIAN', 'MURILLO','1998-05-04')
INSERT CLIENTES VALUES ('654319','JAIRO', 'CAMACHO','1985-10-03')
INSERT CLIENTES VALUES ('654318','CAMILA', 'MORENO','1990-03-20')
INSERT CLIENTES VALUES ('654317','CARLOS', 'CONTRERAS','1992-01-01')
INSERT CLIENTES VALUES ('654316','WENDY', 'JARA','1997-04-02')
INSERT CLIENTES VALUES ('654315','JULIETA', 'RIANO','1970-06-06')
INSERT CLIENTES VALUES ('654314','DARWIN', 'ARRIETA','1964-08-24')
INSERT CLIENTES VALUES ('654313','MIGUEL', 'REYES','1990-01-04')
INSERT CLIENTES VALUES ('654312','FELIPE', 'JIMENEZ','1987-06-08')

GO

--EXECUTE CLIENTES @CRUD='I', @DOCUMENTO='123456', @NOMBRES='TATIANA', @APELLIDOS='SEGURA', @FECHA_NACIMIENTO='1997-03-27'
--SELECT * FROM CLIENTES ---WHERE DOCUMENTO = '654321' ;
